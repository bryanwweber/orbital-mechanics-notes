
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Example: Nonimpulsive Maneuvers &#8212; Orbital Mechanics &amp; Astrodynamics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/copyHeaderPermalink.css?v=efcfb0aa" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"vector": ["\\boldsymbol{#1}", 1], "uvec": ["\\boldsymbol{\\hat{#1}}", 1], "mag": ["\\lVert#1\\rVert", 1], "cross": "\\times", "unit": ["#1~\\mathrm{#2}", 2], "pf": ["{#1}_{\\omega}", 1], "mat": ["\\left[\\mathbf{#1}\\right]", 1], "COG": "\\mathrm{COG}", "KE": "\\mathrm{KE}", "PE": "V"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'orbital-maneuvers/nonimpulsive-maneuver-example';</script>
    <script src="../_static/copyHeaderPermalink.js?v=eb7e8955"></script>
    <link rel="canonical" href="https://orbital-mechanics.space/orbital-maneuvers/nonimpulsive-maneuver-example.html" />
    <link rel="icon" href="../_static/favicon-16x16.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Nonimpulsive Orbital Maneuvers" href="nonimpulsive-orbital-maneuvers.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/hohmann-light.svg" class="logo__image only-light" alt="Orbital Mechanics & Astrodynamics - Home"/>
    <img src="../_static/hohmann-dark.svg" class="logo__image only-dark pst-js-only" alt="Orbital Mechanics & Astrodynamics - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro/reference-frames.html">Reference Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/mass-force-and-newtons-law-of-gravitation.html">Mass, Force, and Newtonâ€™s Law of Gravitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/force-acceleration-and-momentum.html">Force, Acceleration, and Momentum</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The N-Body Problem</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../the-n-body-problem/two-body-inertial-motion.html">Two-Body Equations of Motion in an Inertial Frame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-n-body-problem/two-body-inertial-numerical-solution.html">Two-Body Numerical Solution in an Inertial Frame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-n-body-problem/motion-of-the-barycenter.html">Motion of the Barycenter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-n-body-problem/two-body-relative-motion.html">Relative Motion in the Two-Body Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-n-body-problem/two-body-relative-numerical-solution.html">Two-Body Problem in the Co-Moving Frame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-n-body-problem/circular-restricted-three-body-problem.html">Circular Restricted Three-Body Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-n-body-problem/lagrange-points.html">Application of the CR3BP: Lagrange Points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-n-body-problem/Lagrange-points-example.html">Example: Plotting Lagrange Points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-n-body-problem/jacobi-constant.html">The Jacobi Constant</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-n-body-problem/Equations-of-Motion-CR3BP.html">Example: CR3BP Equations of Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-n-body-problem/many-body-problems.html">Many-Body Problems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Constants of Orbital Motion</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../constants-of-orbital-motion/energy-is-conserved-in-orbital-motion.html">Energy Is Conserved In Orbital Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../constants-of-orbital-motion/angular-momentum-is-conserved.html">Angular Momentum Is Conserved In Orbital Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../constants-of-orbital-motion/orbital-plane-and-keplers-second-law.html">Orbital Plane and Keplerâ€™s Second Law</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Orbit Equation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../the-orbit-equation/the-orbit-equation.html">The Orbit Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-orbit-equation/orbital-nomenclature.html">Orbital Nomenclature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-orbit-equation/circular-orbits.html">Circular Orbits (<span class="math notranslate nohighlight">\(e = 0\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-orbit-equation/elliptical-orbits.html">Elliptical Orbits (<span class="math notranslate nohighlight">\(0 &lt; e &lt; 1\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-orbit-equation/parabolic-trajectories.html">Parabolic Trajectories (<span class="math notranslate nohighlight">\(e = 1\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-orbit-equation/hyperbolic-trajectories.html">Hyperbolic Trajectories (<span class="math notranslate nohighlight">\(e &gt; 1\)</span>)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Classical Orbital Elements</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../classical-orbital-elements/perifocal-frame.html">Perifocal Frame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classical-orbital-elements/right-ascension-declination.html">Right Ascension and Declination Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classical-orbital-elements/classical-orbital-elements.html">Classical Orbital Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classical-orbital-elements/orbital-elements-and-the-state-vector.html">Classical Orbital Elements and the State Vector</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Time Since Periapsis &amp; Kepler's Equation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../time-since-periapsis-and-keplers-equation/time-since-periapsis.html">Time Since Periapsis, Mean Anomaly, and Eccentric Anomaly</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time-since-periapsis-and-keplers-equation/elliptical-orbits.html">Circular and Elliptical Orbits (<span class="math notranslate nohighlight">\(e &lt; 1\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time-since-periapsis-and-keplers-equation/elliptical-orbit-example.html">Example: Elliptical Orbit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time-since-periapsis-and-keplers-equation/elliptical-orbit-time-in-shadow.html">Example: Time in Earthâ€™s Shadow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time-since-periapsis-and-keplers-equation/parabolic-trajectories.html">Parabolic Trajectories (<span class="math notranslate nohighlight">\(e = 1\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time-since-periapsis-and-keplers-equation/hyperbolic-trajectories.html">Hyperbolic Trajectories (<span class="math notranslate nohighlight">\(e &gt; 1\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time-since-periapsis-and-keplers-equation/hyperbolic-trajectory-example.html">Example: Hyperbolic Trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time-since-periapsis-and-keplers-equation/the-lagrange-coefficients.html">The Lagrange Coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time-since-periapsis-and-keplers-equation/universal-variables.html">Orbit Independent Solution: The Universal Anomaly</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time-since-periapsis-and-keplers-equation/universal-variables-example.html">Example: Universal Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time-since-periapsis-and-keplers-equation/universal-lagrange-coefficients-example.html">Example: Universal Lagrange Coefficients</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Orbital Maneuvers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="impulsive-maneuvers.html">Impulsive Maneuvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="single-impulse-example.html">Single Impulse Orbital Change</a></li>
<li class="toctree-l1"><a class="reference internal" href="hohmann-transfer.html">Hohmann Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="hohmann-transfer-example.html">Example: Hohmann Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="bielliptic-hohmann-transfer.html">Bi-elliptic Hohmann transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison-of-bielliptic-and-hohmann.html">Example: Comparison of Bi-elliptic and Two-Impulse Hohmann Transfers</a></li>
<li class="toctree-l1"><a class="reference internal" href="phasing-maneuvers.html">Phasing Maneuvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="non-hohmann-transfers.html">Non-Hohmann Transfers with a Common Apse Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-apse-line-example.html">Non-Hohmann Transfers: Common Apse Line Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="apse-line-rotation-example.html">Non-Hohmann Transfers: Apse Line Rotation Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="plane-change-maneuvers.html">Plane Change Maneuvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="plane-change-example.html">Example: Plane Change Maneuver</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Interplanetary Trajectories</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../interplanetary-maneuvers/introduction.html">Interplanetary Trajectories and Maneuvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interplanetary-maneuvers/heliocentric-trajectories.html">Heliocentric Trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interplanetary-maneuvers/interplanetary-transfer-phasing.html">Interplanetary Transfer Phasing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interplanetary-maneuvers/sphere-of-influence.html">Sphere of Influence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interplanetary-maneuvers/planetary-departure-trajectory.html">Planetary Departure for Interplanetary Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interplanetary-maneuvers/planetary-arrival-capture.html">Planetary Arrival: Capture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interplanetary-maneuvers/planetary-arrival-flyby.html">Planetary Arrival: Flyby</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Review of Vectors, Kinematics, and Newtonian Mechanics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../review/kinematics.html">Kinematics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../review/time-derivatives-of-moving-vectors.html">Time Derivatives of Moving Vectors</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reference/celestial-sphere.html">Celestial Sphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/relative-motion.html">Relative Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/planetary-parameters.html">Planetary Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/julian-date.html">Julian Day</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/planetary-ephemeris.html">Planetary Ephemeris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/gravity-and-spherical-symmetry.html">Gravity and Spherical Symmetry</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Postscript</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../interplanetary-maneuvers/planetary-depahture-trajectory.html">Planetary Depahture for Interplanetary Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonimpulsive-orbital-maneuvers.html">Nonimpulsive Orbital Maneuvers</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Example: Nonimpulsive Maneuvers</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/bryanwweber/orbital-mechanics-notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/bryanwweber/orbital-mechanics-notes/edit/main/orbital-maneuvers/nonimpulsive-maneuver-example.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/bryanwweber/orbital-mechanics-notes/issues/new?title=Issue%20on%20page%20%2Forbital-maneuvers/nonimpulsive-maneuver-example.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/orbital-maneuvers/nonimpulsive-maneuver-example.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Example: Nonimpulsive Maneuvers</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="example-nonimpulsive-maneuvers">
<h1>Example: Nonimpulsive Maneuvers<a class="headerlink" href="#example-nonimpulsive-maneuvers" title="Link to this heading">#</a></h1>
<p>Consider a 1000 kg spacecraft with an ion propulsion system. These systems are capable of extremely high efficiency but generally have low thrust. This particular system has an <span class="math notranslate nohighlight">\(I_{sp}\)</span> of 10,000 s and a thrust of 2.5 N. The spacecraft is in a 300 km circular, equatorial, orbit around Earth. At <span class="math notranslate nohighlight">\(t\)</span> = 0, the ion propulsion system is turned on, and remains on until the spacecraft reaches GEO. How long does it take for the spacecraft to reach GEO? How many orbital revolutions does it take to get to GEO? How much mass is used during the maneuver? Compare this propellant usage to a typical, high-thrust (impulsive) maneuver with a rocket with <span class="math notranslate nohighlight">\(I_{sp}\)</span> of 300 s.</p>
<section id="solution">
<h2>Solution<a class="headerlink" href="#solution" title="Link to this heading">#</a></h2>
<p>To solve this problem, we will integrate the equations of motion with respect to time. Since the thrust is applied continuously, we cannot assume that the maneuver is impulsive. The equations of motion are given by:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}\ddot{x} &amp;= -\mu\frac{x}{r^3} + \frac{T}{m}\frac{\dot{x}}{v} &amp; \ddot{y} &amp;= -\mu\frac{y}{r^3} + \frac{T}{m}\frac{\dot{y}}{v} &amp; \ddot{z} &amp;= -\mu\frac{z}{r^3} + \frac{T}{m}\frac{\dot{z}}{v}\end{aligned}\]</div>
<p>In addition, we have to add an equation for the conservation of mass. Since the propulsion device works by ejecting mass overboard, the mass is reduced as the thrust is applied. This is given by:</p>
<div class="math notranslate nohighlight">
\[\frac{dm}{dt} = -\frac{T}{I_{sp}g_0}\]</div>
<p>Now we need to construct the initial state vector. The state vector will have 7 components, the three position coordinates, the three velocity components, and the mass. Since the initial orbit is circular, the initial position is arbitrary, so we will chose it to be on the <span class="math notranslate nohighlight">\(x\)</span> axis for convenience. In turn, this means that the only initial velocity component is in the <span class="math notranslate nohighlight">\(y\)</span> direction:</p>
<div class="math notranslate nohighlight">
\[\vector{v}_0 = \sqrt{\frac{\mu}{r_0}}\uvec{\jmath}\]</div>
<p>The final radius, <span class="math notranslate nohighlight">\(r_2\)</span>, is 42,164 km, at GEO.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %matplotlib notebook</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circle</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_ivp</span>

<span class="n">R_E</span> <span class="o">=</span> <span class="mi">6378</span>  <span class="c1"># km</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">3.986e5</span>  <span class="c1"># km**3/s**2</span>

<span class="n">r_LEO</span> <span class="o">=</span> <span class="n">R_E</span> <span class="o">+</span> <span class="mi">300</span>  <span class="c1"># km</span>
<span class="n">v_LEO</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="n">r_LEO</span><span class="p">)</span>  <span class="c1"># km/s</span>

<span class="n">r_2</span> <span class="o">=</span> <span class="mi">42_164</span>  <span class="c1"># km, GEO</span>

<span class="n">r_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">r_LEO</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># km</span>
<span class="n">v_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">v_LEO</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># km/s</span>
<span class="n">m_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># kg</span>
<span class="n">Y_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">r_0</span><span class="p">,</span> <span class="n">v_0</span><span class="p">,</span> <span class="n">m_0</span><span class="p">))</span>

<span class="n">T</span> <span class="o">=</span> <span class="mf">2.5e-3</span>  <span class="c1"># kN</span>
<span class="n">I_sp</span> <span class="o">=</span> <span class="mi">10_000</span>  <span class="c1"># s</span>
<span class="n">g_0</span> <span class="o">=</span> <span class="mf">9.807e-3</span>  <span class="c1"># km/s**2</span>
</pre></div>
</div>
</div>
</div>
<p>Now we need to define the function that calculates the right hand side of the system of equations. For convenience, we will call the solution vector <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">nonimpulsive_maneuver</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">I_sp</span><span class="p">,</span> <span class="n">g_0</span><span class="p">,</span> <span class="n">r_2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Residual function for non-impulsive maneuvers.</span>

<span class="sd">    t: Current simulation time</span>
<span class="sd">    Y: State vector [x y z xdot ydot zdot m], km, km/s, kg</span>
<span class="sd">    mu: Gravitational parameter, km**3/s**2</span>
<span class="sd">    T: Thrust, kN</span>
<span class="sd">    I_sp: Specific impulse, s</span>
<span class="sd">    g_0: Standard sea-level gravity, km/s**2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]))</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]))</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dY_dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
    <span class="n">dY_dt</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">dY_dt</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="n">r</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
    <span class="n">dY_dt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">I_sp</span> <span class="o">*</span> <span class="n">g_0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dY_dt</span>
</pre></div>
</div>
</div>
</div>
<p>In addition to the function defining the residual, we will define several event functions. The SciPy ODE solver will find the time when the return value of an event function is zero and store that as part of the solution. We can also use events to terminate the integration before the specified end time. Event functions are regular Python functions that return a floating point value; the solver then records the time and solution vector when a zero value is returned.</p>
<p>Note that the function arguments for the event functions must be the same as the residual function, even if the arguments are not used.</p>
<p>First, we will define a function that determines whether the spacecraft has reached GEO. This will happen when the orbital radius is equal to <span class="math notranslate nohighlight">\(r_2\)</span> above, or when the difference between the current radius and the desired radius is zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">reached_destination</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">I_sp</span><span class="p">,</span> <span class="n">g_0</span><span class="p">,</span> <span class="n">r_2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine if the spacecraft reaches the destination radius.</span>

<span class="sd">    Returns the difference between the current orbital radius and the</span>
<span class="sd">    destination radius.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r_vec</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r_vec</span><span class="p">,</span> <span class="n">r_vec</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">r</span> <span class="o">-</span> <span class="n">r_2</span>
</pre></div>
</div>
</div>
</div>
<p>When the spacecraft reaches the destination radius, we no longer need to keep integrating, so we can set the <code class="docutils literal notranslate"><span class="pre">terminal</span></code> attribute on the event function to be equal to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reached_destination</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<p>We also know that the mass of the spacecraft cannot go below zero. Here, we define a function that only returns the last element of the solution vector, which is the current value of the mass. If this becomes zero, the integration should terminate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mass</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">I_sp</span><span class="p">,</span> <span class="n">g_0</span><span class="p">,</span> <span class="n">r_2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the current mass of the spacecraft.</span>

<span class="sd">    The mass is stored in the last element of the solution vector.</span>
<span class="sd">    If this becomes zero, the integration should terminate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="n">mass</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, to determine the number of orbits that occur, we want to know the number of times that the <span class="math notranslate nohighlight">\(y\)</span>-component of the position crosses zero. This happens twice on each orbit. To avoid double counting, we can use the <code class="docutils literal notranslate"><span class="pre">direction</span></code> attribute to only trigger the event when the zero crossing happens in a particular direction:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">direction</span> <span class="pre">=</span> <span class="pre">-1</span></code>: Record when the zero crossing goes from positive to negative</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direction</span> <span class="pre">=</span> <span class="pre">1</span></code>: Record when the zero crossing goes from negative to positive</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direction</span> <span class="pre">=</span> <span class="pre">0</span></code>: Record every time that the event happens</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">orbit</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">I_sp</span><span class="p">,</span> <span class="n">g_0</span><span class="p">,</span> <span class="n">r_2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Trigger when the y-component of the position crosses zero.</span>

<span class="sd">    Useful to count the number of orbits.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>


<span class="c1"># Only trigger when going from negative to positive</span>
<span class="n">orbit</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Now weâ€™re ready to integrate. We pass the three event functions to the <code class="docutils literal notranslate"><span class="pre">events</span></code> keyword argument, and weâ€™ll set the maximum integration time to 2,000,000 seconds. We also want to get a million points worth of time steps for plotting.</p>
<p>The last things we need to adjust for the integrator are the tolerances and the integration method. The integrator tolerances control how accurate the solution produced by the integrator is. There are two tolerances, the <em>relative tolerance</em> (<code class="docutils literal notranslate"><span class="pre">rtol</span></code>) and the <em>absolute tolerance</em> (<code class="docutils literal notranslate"><span class="pre">atol</span></code>).</p>
<p>The relative tolerance determines roughly how many digits of precision will be correct in the answer, while the absolute tolerance determines roughly how close the solution is to an analytical solution. The default tolerances are <code class="docutils literal notranslate"><span class="pre">rtol=1E-3</span></code> and <code class="docutils literal notranslate"><span class="pre">atol=1E-6</span></code>, meaning that we can expect about 3 digits of precision and that the solution will be within about 1Ã—10<sup>-6</sup> of an analytical solution.</p>
<p>Due to the very long integration time here, the default tolerances are not strict enough to achieve an accurate solution. My strategy to change the tolerances is to adjust them by three orders of magnitude at a time. This is a totally arbitrary strategy, but Iâ€™ve found it to be effective over the years. We should ensure that the solution does not change when we adjust the tolerances.</p>
<p>I found that I needed to set <code class="docutils literal notranslate"><span class="pre">rtol=1E-12</span></code> and <code class="docutils literal notranslate"><span class="pre">atol=1E-15</span></code> to have a stable answer. This is about as small as the tolerances can be set and still affect the solution. This is because computers represent floating point numbers with about 15 digits of precision, so setting <code class="docutils literal notranslate"><span class="pre">atol</span></code> to be smaller than 1Ã—10<sup>-15</sup> does not affect the result any longer.</p>
<p>Using the default <code class="docutils literal notranslate"><span class="pre">method</span></code>, a 4th-order Runge-Kutta solver, with these tolerances took a very long time to solve. Fortunately, SciPy includes other solvers. In this case the <code class="docutils literal notranslate"><span class="pre">DOP853</span></code> solver, a 7th-order Runge-Kutta solver, is able to solve the problem in a more reasonable time.</p>
<p>With these changes, we can solve the problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_end</span> <span class="o">=</span> <span class="mi">2_000_000</span>  <span class="c1"># s</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e6</span><span class="p">))</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
    <span class="n">nonimpulsive_maneuver</span><span class="p">,</span>
    <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_end</span><span class="p">),</span>
    <span class="n">y0</span><span class="o">=</span><span class="n">Y_0</span><span class="p">,</span>
    <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span>
    <span class="n">events</span><span class="o">=</span><span class="p">(</span><span class="n">reached_destination</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">orbit</span><span class="p">),</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span>
    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DOP853&quot;</span><span class="p">,</span>
    <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">I_sp</span><span class="p">,</span> <span class="n">g_0</span><span class="p">,</span> <span class="n">r_2</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>The solution object is stored in <code class="docutils literal notranslate"><span class="pre">sol</span></code>, and we print <code class="docutils literal notranslate"><span class="pre">sol.status</span></code> at the end of the integration. If <code class="docutils literal notranslate"><span class="pre">sol.status</span></code> is <code class="docutils literal notranslate"><span class="pre">0</span></code>, the integrator reached the specified end time. If <code class="docutils literal notranslate"><span class="pre">sol.status</span></code> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, the integration was terminated due to an event. In this case, the integration was terminated due to an event triggering.</p>
<p>The time and solution vector values for the events are stored in the <code class="docutils literal notranslate"><span class="pre">sol.t_events</span></code> and <code class="docutils literal notranslate"><span class="pre">sol.y_events</span></code> attributes, respectively. These attributes refer to lists, where each element of the list corresponds to one of the event functions, in the order that they were specified to the <code class="docutils literal notranslate"><span class="pre">events</span></code> keyword.</p>
<p>For this problem, the first element of <code class="docutils literal notranslate"><span class="pre">sol.t_events</span></code> is the time of the <code class="docutils literal notranslate"><span class="pre">reached_destination</span></code> event, the second element is the time of the <code class="docutils literal notranslate"><span class="pre">mass</span></code> event, and the third element are the times of the <code class="docutils literal notranslate"><span class="pre">orbit</span></code> counts. Since <code class="docutils literal notranslate"><span class="pre">reached_destination</span></code> and <code class="docutils literal notranslate"><span class="pre">mass</span></code> are terminal events, they can only occur once. We can print the <code class="docutils literal notranslate"><span class="pre">t_events</span></code> for those two events to see which was triggered:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t_events</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[array([1817381.70314192]), array([], dtype=float64)]
</pre></div>
</div>
</div>
</div>
<p>Here we can see that a time is reported for the first event (<code class="docutils literal notranslate"><span class="pre">reached_destination</span></code>) and not for the second event (<code class="docutils literal notranslate"><span class="pre">mass</span></code>). Thus, we conclude that the spacecraft reached its destination radius!</p>
<p>Now letâ€™s plot the solution. As before, we can get the solution vectors with the <code class="docutils literal notranslate"><span class="pre">sol.y</span></code> attribute:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_vec</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r_vec</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">r_vec</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">r_vec</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">v_vec</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v_vec</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v_vec</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v_vec</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">R_E</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;Earth&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">r_2</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_vec</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">r_vec</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C2&quot;</span><span class="p">)</span>
<span class="n">orbit_crossings</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y_events</span><span class="p">[</span><span class="mi">2</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orbit_crossings</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">orbit_crossings</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="s2">&quot;ko&quot;</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f06d4464320&gt;]
</pre></div>
</div>
<img alt="../_images/d7d9f45ce4354582b1f37545108695cb70180da7dfaa14f5eac772d9a19b1bd0.png" src="../_images/d7d9f45ce4354582b1f37545108695cb70180da7dfaa14f5eac772d9a19b1bd0.png" />
</div>
</div>
<p>We can see that the spacecraft begins in its 300 km initial orbit and spirals out until it reaches GEO, shown by the dashed line. Also plotted are all the times that the spacecraft crosses the <span class="math notranslate nohighlight">\(x\)</span> axis. We can get the number of elements in the <code class="docutils literal notranslate"><span class="pre">sol.t_events</span></code> array associated with the <code class="docutils literal notranslate"><span class="pre">orbit</span></code> event to determine the number of times the event was triggered:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The number of orbits is: </span><span class="si">{</span><span class="n">sol</span><span class="o">.</span><span class="n">t_events</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The number of orbits is: 137
</pre></div>
</div>
</div>
</div>
<p>The number of orbits is one less than this number, since the last orbit isnâ€™t completed.</p>
<p>The amount of propellant used is the difference between the initial mass <code class="docutils literal notranslate"><span class="pre">m_0</span></code> and the final value of the <code class="docutils literal notranslate"><span class="pre">m</span></code> array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The flight used: </span><span class="si">{</span><span class="n">m_0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4F</span><span class="si">}</span><span class="s2"> kg of propellant&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The flight used: 46.3286 kg of propellant
</pre></div>
</div>
</div>
</div>
<p>The time of flight is the time that the <code class="docutils literal notranslate"><span class="pre">reached_destination</span></code> event was triggered:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time of flight: </span><span class="si">{</span><span class="n">sol</span><span class="o">.</span><span class="n">t_events</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">3600</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span><span class="si">:</span><span class="s2">.4F</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Time of flight: 21.0345 days
</pre></div>
</div>
</div>
</div>
<p>Finally, letâ€™s compare this to an impulsive Hohmann transfer maneuver.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">r_LEO</span> <span class="o">*</span> <span class="n">r_2</span> <span class="o">/</span> <span class="p">(</span><span class="n">r_LEO</span> <span class="o">+</span> <span class="n">r_2</span><span class="p">))</span>
<span class="n">delta_v_1</span> <span class="o">=</span> <span class="n">h_t</span> <span class="o">/</span> <span class="n">r_LEO</span> <span class="o">-</span> <span class="n">v_LEO</span>
<span class="n">delta_v_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="n">r_2</span><span class="p">)</span> <span class="o">-</span> <span class="n">h_t</span> <span class="o">/</span> <span class="n">r_2</span>
<span class="n">delta_v_t</span> <span class="o">=</span> <span class="n">delta_v_1</span> <span class="o">+</span> <span class="n">delta_v_2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The Î”v for a Hohmann transfer is: </span><span class="si">{</span><span class="n">delta_v_t</span><span class="si">:</span><span class="s2">.4F</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>

<span class="n">delta_m</span> <span class="o">=</span> <span class="n">m_0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_v_t</span> <span class="o">/</span> <span class="p">(</span><span class="mi">300</span> <span class="o">*</span> <span class="n">g_0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The Î”m for a Hohmann transfer is: </span><span class="si">{</span><span class="n">delta_m</span><span class="si">:</span><span class="s2">.4F</span><span class="si">}</span><span class="s2"> kg&quot;</span><span class="p">)</span>

<span class="n">transit_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">r_LEO</span> <span class="o">+</span> <span class="n">r_2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The time of flight for a Hohmann transfer is: </span><span class="si">{</span><span class="n">transit_t</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">3600</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span><span class="si">:</span><span class="s2">.4F</span><span class="si">}</span><span class="s2"> days&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Î”v for a Hohmann transfer is: 3.8926 km/s
The Î”m for a Hohmann transfer is: 733.6837 kg
The time of flight for a Hohmann transfer is: 0.2198 days
</pre></div>
</div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(\Delta m\)</span> requirement for the Hohmann transfer is nearly 3/4 of the initial mass of the spacecraft! On the other hand, the time of flight is less than a quarter of a day, as compared to three weeks for the non-impulsive maneuver.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./orbital-maneuvers"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="nonimpulsive-orbital-maneuvers.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Nonimpulsive Orbital Maneuvers</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bryan Weber
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text"><a rel="cc:attributionURL" property="dct:title" href="https://orbital-mechanics.space">Orbital Mechanics & Astrodynamics</a> by <span property="cc:attributionName">Bryan Weber</span> is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" /></a></p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>